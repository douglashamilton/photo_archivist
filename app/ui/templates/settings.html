{% extends "base.html" %}
{% from "_partials.html" import flash_message, loading_indicator %}

{% block title %}Settings - Photo Archivist{% endblock %}

{% block content %}
<div class="bg-white rounded-lg shadow px-5 py-6 sm:px-6">
    <div class="mb-6">
        <h1 class="text-2xl font-bold text-gray-900">Settings</h1>
        <p class="mt-1 text-sm text-gray-500">Configure application preferences</p>
    </div>

    <div class="space-y-6">
        {# Sync Settings #}
        <div class="border-b border-gray-200 pb-6">
            <h2 class="text-lg font-medium text-gray-900">Sync Settings</h2>
            <form class="mt-4 space-y-4" hx-post="/api/settings/sync" hx-trigger="submit">
                <div>
                    <label class="flex items-center">
                        <input type="checkbox" name="auto_sync_enabled" class="h-4 w-4 text-blue-600 rounded border-gray-300"
                               {% if settings.auto_sync_enabled %}checked{% endif %}
                               hx-post="/api/settings/sync"
                               hx-trigger="change"
                               hx-swap="none">
                        <span class="ml-2 text-sm text-gray-700">Enable automatic sync</span>
                    </label>
                </div>
                
                <div>
                    <label for="sync_interval" class="block text-sm font-medium text-gray-700">Sync interval (minutes)</label>
                    <input type="number" name="sync_interval" id="sync_interval"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                           value="{{ settings.sync_interval }}"
                           min="5"
                           max="1440"
                           hx-post="/api/settings/sync"
                           hx-trigger="change[target.validity.valid] delay:500ms"
                           hx-swap="none">
                </div>
            </form>
        </div>

        {# Photo Scoring #}
        <div class="border-b border-gray-200 pb-6">
            <h2 class="text-lg font-medium text-gray-900">Photo Scoring</h2>
            <form class="mt-4 space-y-4" hx-post="/api/settings/scoring" hx-trigger="submit">
                <div>
                    <label for="quality_threshold" class="block text-sm font-medium text-gray-700">Minimum quality score</label>
                    <input type="number" name="quality_threshold" id="quality_threshold"
                           class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                           value="{{ settings.quality_threshold }}"
                           min="0"
                           max="100"
                           step="5"
                           hx-post="/api/settings/scoring"
                           hx-trigger="change[target.validity.valid] delay:500ms"
                           hx-swap="none">
                    <p class="mt-1 text-sm text-gray-500">Photos below this score will be filtered out</p>
                </div>

                <div>
                    <label class="flex items-center">
                        <input type="checkbox" name="auto_dedupe" class="h-4 w-4 text-blue-600 rounded border-gray-300"
                               {% if settings.auto_dedupe %}checked{% endif %}
                               hx-post="/api/settings/scoring"
                               hx-trigger="change"
                               hx-swap="none">
                        <span class="ml-2 text-sm text-gray-700">Automatically remove duplicate photos</span>
                    </label>
                </div>
            </form>
        </div>

        {# Print Settings #}
        <div>
            <h2 class="text-lg font-medium text-gray-900">Print Settings</h2>
            <form class="mt-4 space-y-4" hx-post="/api/settings/print" hx-trigger="submit">
                <div>
                    <label for="default_print_size" class="block text-sm font-medium text-gray-700">Default print size</label>
                    <select name="default_print_size" id="default_print_size"
                            class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"
                            hx-post="/api/settings/print"
                            hx-trigger="change"
                            hx-swap="none">
                        <option value="4x6" {% if settings.default_print_size == '4x6' %}selected{% endif %}>4×6 inches</option>
                        <option value="5x7" {% if settings.default_print_size == '5x7' %}selected{% endif %}>5×7 inches</option>
                        <option value="6x8" {% if settings.default_print_size == '6x8' %}selected{% endif %}>6×8 inches</option>
                    </select>
                </div>
            </form>
        </div>
    </div>

    {# Status Messages #}
    <div id="settings-status"></div>
</div>
{% endblock %}